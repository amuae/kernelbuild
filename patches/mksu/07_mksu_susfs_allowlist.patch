diff --git a/kernel/allowlist.c b/kernel/allowlist.c
index c9a68e27..86624c55 100644
--- a/kernel/allowlist.c
+++ b/kernel/allowlist.c
@@ -17,7 +17,9 @@
 #include "selinux/selinux.h"
 #include "allowlist.h"
 #include "manager.h"
+#ifndef CONFIG_KSU_SUSFS
 #include "syscall_hook_manager.h"
+#endif // #ifndef CONFIG_KSU_SUSFS
 
 #define FILE_MAGIC 0x7f4b5355 // ' KSU', u32
 #define FILE_FORMAT_VERSION 3 // u32
@@ -258,8 +260,10 @@ out:
 
     if (persist) {
         persistent_allow_list();
+#ifndef CONFIG_KSU_SUSFS
         // FIXME: use a new flag
         ksu_mark_running_process();
+#endif // #ifndef CONFIG_KSU_SUSFS
     }
 
     return result;
